<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login - Ali Software Jurídico</title>
    <meta name="description" content="Acesse sua conta no Ali Software Jurídico. Login seguro e rápido.">
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <meta name="keywords" content="login, acesso, advocacia, software jurídico">
    <meta name="author" content="Ali Software Jurídico">
    <meta name="robots" content="noindex, nofollow">
    <link rel="preload" href="../css/main.css?v=v-2025-09-23-1" as="style">
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" as="style">
    <link rel="stylesheet" href="../css/main.css?v=v-2025-09-23-1">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="header-content">
                <a href="../index.html" class="logo" aria-label="Voltar ao início">
                    <img src="../logo.png?v=v-2025-09-23-1" alt="Ali Software Jurídico" class="logo-image" loading="lazy">
                </a>
                <nav class="nav-menu" role="navigation" aria-label="Menu principal">
                    <a href="../pages/planos.html" class="nav-item">Planos</a>
                    <a href="../pages/trial.html" class="btn btn-primary">Experimentar grátis</a>
                </nav>
            </div>
        </div>
    </header>
    <main class="main-content">
        <div class="container">
            <div class="login-bg">
                <div class="login-center">
                    <div class="login-card-modern">
                        <!-- Logo removida para evitar duplicidade, já existe no header -->
                        <h1 class="login-title">Acesse sua conta</h1>
                        <p class="login-subtitle">Bem-vindo! Entre para acessar o painel completo.</p>
                        <form id="loginForm" class="form-modern">
                            <div class="form-group">
                                <label for="email" class="form-label">E-mail</label>
                                <input type="email" id="email" name="email" class="form-input" placeholder="seu@email.com" required autofocus autocomplete="username">
                            </div>
                            <div class="form-group">
                                <label for="password" class="form-label">Senha</label>
                                <input type="password" id="password" name="password" class="form-input" placeholder="Digite sua senha" required autocomplete="current-password">
                            </div>
                            <div class="form-group form-remember">
                                <input type="checkbox" id="remember" name="remember" class="form-checkbox">
                                <label for="remember" class="checkbox-label">Lembrar de mim</label>
                            </div>
                            <button type="submit" class="btn btn-primary btn-full">Entrar</button>
                        </form>
                        <div class="login-links-modern">
                            <a href="#" class="link" id="forgotPasswordLink">Esqueceu a senha?</a>
                            <span>Não tem conta? <a href="trial.html" class="link">Comece grátis</a></span>
                        </div>
                        <div id="loginMsg" aria-live="polite"></div>
                    </div>
                </div>
            </div>
        </div>
    </main>
    <style>
        .logo-login-img { height: 48px; }
        #loginMsg {
            margin-top: 1rem;
        }
        /* Foco visível para acessibilidade */
        .form-input:focus, .btn:focus, .form-checkbox:focus {
            outline: 2px solid #2563eb;
            outline-offset: 2px;
        }
        .btn-primary, .btn-primary:visited {
            background-color: #2563eb !important;
            color: #fff !important;
            border: 2px solid #2563eb !important;
        }
        .btn-primary:focus, .btn-primary:hover {
            background-color: #1e40af !important;
            border-color: #1e40af !important;
        }
        .form-input, .form-input:visited {
            background: #fff;
            color: #222;
            border: 1.5px solid #2563eb;
        }
        .form-input:focus {
            border-color: #1e40af;
        }
        .form-label {
            font-weight: 600;
            color: #222;
        }
        .checkbox-label {
            color: #222;
        }
    </style>
    <footer class="footer-section">
        <div class="container">
            <div class="grid grid-cols-4 footer-grid-container">
                <div>
                    <a href="../index.html" class="logo footer-logo" aria-label="Voltar ao topo">
                        <img src="../logo.png?v=v-2025-09-23-1" alt="Ali Software Jurídico" class="logo-image" loading="lazy">
                    </a>
                    <p class="footer-description-text">
                        Software jurídico completo para advogados e escritórios.
                    </p>
                </div>
                <div>
                    <h6 class="footer-title">Produto</h6>
                    <ul class="footer-list">
                        <li class="footer-list-item"><a href="../index.html#funcionalidades" class="footer-link">Funcionalidades</a></li>
                        <li class="footer-list-item"><a href="../pages/planos.html" class="footer-link">Planos</a></li>
                        <li class="footer-list-item"><a href="../pages/trial.html" class="footer-link">Teste grátis</a></li>
                    </ul>
                </div>
                <div>
                    <h6 class="footer-title">Empresa</h6>
                    <ul class="footer-list">
                        <li class="footer-list-item"><a href="../index.html#sobre" class="footer-link">Sobre</a></li>
                        <li class="footer-list-item"><a href="../index.html#contato" class="footer-link">Contato</a></li>
                        <li class="footer-list-item"><a href="#" class="footer-link">Suporte</a></li>
                    </ul>
                </div>
                <div>
                    <h6 class="footer-title">Legal</h6>
                    <ul class="footer-list">
                        <li class="footer-list-item"><a href="#" class="footer-link">Termos de Uso</a></li>
                        <li class="footer-list-item"><a href="#" class="footer-link">Política de Privacidade</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom-section">
                <p class="footer-bottom-text">
                    © 2025 Ali Software Jurídico. Todos os direitos reservados.
                </p>
            </div>
        </div>
    </footer>
    <a href="https://wa.me/5519991821389?text=Olá! Gostaria de saber mais sobre o Ali Software Jurídico" 
       class="whatsapp-float" 
       target="_blank" 
       rel="noopener"
       aria-label="Falar conosco pelo WhatsApp"
       title="Fale conosco no WhatsApp">
        <i class="fab fa-whatsapp" aria-hidden="true"></i>
    </a>
    <script>
        document.getElementById('loginForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            const email = document.getElementById('email').value.trim();
            const password = document.getElementById('password').value;
            const msgDiv = document.getElementById('loginMsg');
            msgDiv.textContent = '';
            if (!email || !password) {
                msgDiv.style.color = '#ef4444';
                msgDiv.textContent = 'Por favor, preencha todos os campos.';
                return;
            }
            try {
                const resp = await fetch('https://monitor-juridico-ali-software-production.up.railway.app/api/auth/login', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email, password })
                });
                const data = await resp.json();
                if (resp.ok && data.token) {
                    localStorage.setItem('userLoggedIn', 'true');
                    localStorage.setItem('userEmail', data.user.email);
                    localStorage.setItem('userName', data.user.name);
                    localStorage.setItem('userToken', data.token);
                    window.location.href = 'dashboard.html';
                } else {
                    msgDiv.style.color = '#ef4444';
                    msgDiv.textContent = data.error || 'Email ou senha inválidos.';
                }
            } catch (err) {
                msgDiv.style.color = '#ef4444';
                msgDiv.textContent = 'Erro de conexão com o servidor.';
            }
        });

        // Recuperação de senha amigável
        document.getElementById('forgotPasswordLink').addEventListener('click', function(e) {
            e.preventDefault();
            // Cria modal simples
            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.innerHTML = `
                <div class="modal-content" style="max-width:400px;padding:2rem;">
                    <h3>Recuperar senha</h3>
                    <p>Informe seu e-mail cadastrado para receber instruções de redefinição.</p>
                    <form id="forgotForm">
                        <input type="email" id="forgotEmail" class="form-input" placeholder="Seu e-mail" required style="margin-bottom:1rem;width:100%;" autocomplete="username">
                        <button type="submit" class="btn btn-primary btn-full">Enviar</button>
                        <button type="button" class="btn btn-outline btn-full" id="closeModalBtn" style="margin-top:0.5rem;">Cancelar</button>
                    </form>
                    <div id="forgotMsg" style="margin-top:1rem;"></div>
                </div>
            `;
            document.body.appendChild(modal);
            // Fecha modal
            modal.querySelector('#closeModalBtn').onclick = () => modal.remove();
            // Submete email
            modal.querySelector('#forgotForm').onsubmit = async function(ev) {
                ev.preventDefault();
                const email = modal.querySelector('#forgotEmail').value;
                const msgDiv = modal.querySelector('#forgotMsg');
                msgDiv.textContent = '';
                try {
                    const resp = await fetch('http://localhost:3001/api/auth/forgot-password', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ email })
                    });
                    const data = await resp.json();
                    if (resp.ok) {
                        msgDiv.style.color = '#10b981';
                        msgDiv.textContent = 'Se o e-mail existir, você receberá instruções em instantes.';
                    } else {
                        msgDiv.style.color = '#ef4444';
                        msgDiv.textContent = data.error || 'Erro ao solicitar recuperação.';
                    }
                } catch (err) {
                    msgDiv.style.color = '#ef4444';
                    msgDiv.textContent = 'Erro de conexão com o servidor.';
                }
            };
        });
    </script>
</body>
</html>